(this["webpackJsonpipop-visualizer-react"]=this["webpackJsonpipop-visualizer-react"]||[]).push([[0],{146:function(e,t,n){},347:function(e,t,n){},348:function(e,t,n){"use strict";n.r(t);n(146);var a=n(1),s=n.n(a),c=(n(56),n(8)),r=n(15),l=n(9),o=n(17),i=n(16),d=(n(148),n(351)),u=n(139),h=n(0),m=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){return Object(h.jsxs)("section",{id:"rightPanel",children:[Object(h.jsx)("h6",{children:this.props.rightPanelTopic}),Object(h.jsx)("div",{id:"rightPanelContent",children:this.props.children})]})}}]),n}(s.a.Component),j=n(6),b=n.n(j),g=n(10),p=n(140),y=n.n(p),O=n(54),v=n(145),f=n.p+"static/media/down-arrow-ic.a48d0b4e.svg",x=n.p+"static/media/up-arrow-ic.279aab11.svg",N=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).handleOnClick=function(){a.setState((function(e){return{isToggle:!e.isToggle}}))},a.state={isToggle:!1},a}return Object(r.a)(n,[{key:"render",value:function(){return Object(h.jsxs)(O.a,{id:this.props.id,className:this.props.className,style:this.props.style,children:[Object(h.jsx)(O.a.Toggle,{onClick:this.handleOnClick,as:v.a,style:{color:"white",background:"transparent",border:"transparent",outline:"none"},eventKey:this.props.name,children:Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)("div",{className:"col",children:this.props.name}),Object(h.jsx)("div",{className:"col",style:{textAlign:"right"},children:this.state.isToggle?Object(h.jsx)("img",{className:"arrow",src:x,alt:"up-arrow"}):Object(h.jsx)("img",{className:"arrow",src:f,alt:"down-arrow"})})]})}),Object(h.jsx)(O.a.Collapse,{as:g.a.Body,eventKey:this.props.name,style:{backgroundColor:"#213758",padding:"1%"},children:Object(h.jsx)("div",{className:"collapseContent",children:this.props.children})})]})}}]),n}(s.a.Component),k=n(29),B=[{selector:"node",style:{width:"60%",height:"60%",label:"data(label)","text-valign":"center","background-color":"#8AA626","font-weight":"bold","overlay-opacity":"0"}},{selector:"node:selected",style:{"border-width":"30%","border-opacity":"0.3","border-color":"#8AA626"}},{selector:"node.transparent",style:{"background-color":"grey","z-index":"0",opacity:"0.3"}},{selector:"node.subgraph",style:{display:"none"}},{selector:"edge",style:{"line-color":"data(color)",width:"5%","z-index":"3","overlay-opacity":"0",border:"2px solid red"}},{selector:"edge.transparent",style:{"line-color":"grey","z-index":"0",opacity:"0.3"}},{selector:"edge.subgraph",style:{display:"none"}},{selector:"edge:selected",style:{"z-index":"3"}},{selector:"node.notReporting",style:{"background-color":"#A0C3D9"}},{selector:"node.noTunnel",style:{"background-color":"#F2BE22"}},{selector:"node.noTunnel:selected",style:{"border-width":"30%","border-opacity":"0.3","border-color":"#F2BE22"}},{selector:"edge.static",style:{"line-color":"#F27405"}},{selector:"edge.onDemand",style:{"line-color":"#F2D680"}}],E=n(52),S=n.p+"static/media/static_ic.9eb48595.svg",C=n(81),w=n.p+"static/media/ondemand_ic.731a442c.svg",D=n.p+"static/media/connected_ic.b16f1542.svg",I=n.p+"static/media/no_tunnel_ic.3ededd72.svg",M=n.p+"static/media/successor_ic.59f3f80a.svg",L=n.p+"static/media/longdistance_ic.cdc8abdf.svg",T=n.p+"static/media/not_reporting_ic.6bfaba5c.svg",_=n(20),R=n.n(_),P=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).renderNodeDetails=function(){var e=a.state.nodeDetails.sourceNode,t=a.state.nodeDetails.connectedNodes,n=e.raw_data[e.id].geo_coordinate.split(",");fetch("https://maps.googleapis.com/maps/api/geocode/json?latlng=".concat(n[0],",").concat(n[1],"&key=AIzaSyBjkkk4UyMh4-ihU1B1RR7uGocXpKECJhs&language=en")).then((function(e){return e.json()})).then((function(e){try{return e.results[e.results.length-1].formatted_address}catch(t){return"-"}})).then((function(n){var s=Object(h.jsxs)("div",{children:[Object(h.jsx)("h5",{children:e.name}),Object(h.jsx)("div",{className:"DetailsLabel",children:"Node ID"}),e.id,Object(h.jsx)("div",{className:"DetailsLabel",children:"State"}),e.state,Object(h.jsx)("div",{className:"DetailsLabel",children:"City/State/Country"}),n,Object(h.jsx)("hr",{style:{backgroundColor:"#486186"}}),Object(h.jsx)("br",{}),Object(h.jsx)("br",{}),Object(h.jsx)("div",{id:"connectedNode",style:{overflow:"auto"},children:t.map((function(t){try{var n=a.props.topology.getConnectedNodeDetails(e.id,t.data().id);return Object(h.jsxs)(N,{id:t.data().id+"Btn",className:"connectedNodeBtn",eventKey:t.data().label,name:t.data().label,children:[Object(h.jsx)("div",{className:"DetailsLabel",children:"Node ID"}),t.data().id,Object(h.jsx)("div",{className:"DetailsLabel",children:"Tunnel ID"}),n.id,Object(h.jsx)("div",{className:"DetailsLabel",children:"Interface Name"}),n.name,Object(h.jsx)("div",{className:"DetailsLabel",children:"MAC"}),n.MAC,Object(h.jsx)("div",{className:"DetailsLabel",children:"State"}),n.state,Object(h.jsx)("div",{className:"DetailsLabel",children:"Tunnel Type"}),n.type,Object(h.jsx)("div",{className:"DetailsLabel",children:"ICE Role"}),n.stats.IceProperties.role,Object(h.jsx)("div",{className:"DetailsLabel",children:"Remote Address"}),n.remoteAddress,Object(h.jsx)("div",{className:"DetailsLabel",children:"Local Address"}),n.localAddress,Object(h.jsx)("div",{className:"DetailsLabel",children:"Latency"}),n.stats.IceProperties.latency,Object(h.jsxs)(g.a.Body,{className:"transmissionCard",children:["Sent",Object(h.jsx)("div",{className:"DetailsLabel",children:"Byte Sent"}),n.stats.byte_sent,Object(h.jsx)("div",{className:"DetailsLabel",children:"Total Byte Sent"}),n.stats.total_byte_sent]}),Object(h.jsxs)(g.a.Body,{className:"transmissionCard",children:["Received",Object(h.jsx)("div",{className:"DetailsLabel",children:"Byte Received"}),n.stats.byte_receive,Object(h.jsx)("div",{className:"DetailsLabel",children:"Total Byte Received"}),n.stats.total_byte_receive]})]},t.data().id+"Btn")}catch(s){return!1}}))})]});b.a.render(s,document.getElementById("rightPanelContent"))}))},a.renderLinkDetails=function(){var e=a.state.linkDetails.linkDetails,t=a.state.linkDetails.sourceNodeDetails,n=a.state.linkDetails.targetNodeDetails,s=t.raw_data[t.id].geo_coordinate.split(","),c=n.raw_data[n.id].geo_coordinate.split(",");fetch("https://maps.googleapis.com/maps/api/geocode/json?latlng=".concat(s[0],",").concat(s[1],"&key=AIzaSyBjkkk4UyMh4-ihU1B1RR7uGocXpKECJhs&language=en")).then((function(e){return e.json()})).then((function(e){try{return e.results[e.results.length-1].formatted_address}catch(t){return"-"}})).then((function(s){fetch("https://maps.googleapis.com/maps/api/geocode/json?latlng=".concat(c[0],",").concat(c[1],"&key=AIzaSyBjkkk4UyMh4-ihU1B1RR7uGocXpKECJhs&language=en")).then((function(e){return e.json()})).then((function(e){try{return e.results[e.results.length-1].formatted_address}catch(t){return"-"}})).then((function(c){var r,l;a.cy.elements("nodes").forEach((function(e){e.data().id==t.id&&(r=e.css("background-color"))})),a.cy.elements("nodes").forEach((function(e){e.data().id==n.id&&(l=e.css("background-color"))}));var o=Object(h.jsxs)("div",{children:[Object(h.jsx)("h5",{children:e.name}),Object(h.jsxs)("div",{className:"row",children:[Object(h.jsxs)("div",{className:"col-10",style:{paddingRight:"0"},children:[Object(h.jsxs)(N,{id:t.id+"Btn",className:"sourceNodeBtn",eventKey:t.id+"Btn",name:t.name,style:{marginBottom:"2.5%",backgroundColor:r,border:"solid ".concat(r)},children:[Object(h.jsx)("div",{className:"DetailsLabel",children:"Node ID"}),t.id,Object(h.jsx)("div",{className:"DetailsLabel",children:"State"}),t.state,Object(h.jsx)("div",{className:"DetailsLabel",children:"City/State/Country"}),s]},t.id+"Btn"),Object(h.jsxs)(N,{id:n.id+"Btn",className:"targetNodeBtn",eventKey:n.id+"Btn",name:n.name,style:{marginBottom:"2.5%",backgroundColor:l,border:"solid ".concat(l)},children:[Object(h.jsx)("div",{className:"DetailsLabel",children:"Node ID"}),n.id,Object(h.jsx)("div",{className:"DetailsLabel",children:"State"}),n.state,Object(h.jsx)("div",{className:"DetailsLabel",children:"City/Country"}),c]},n.id+"Btn")]}),Object(h.jsx)("div",{className:"col",style:{margin:"auto",padding:"0",textAlign:"center"},children:Object(h.jsx)("button",{onClick:a.handleSwitch,id:"switchBtn"})})]}),Object(h.jsx)("hr",{style:{backgroundColor:"#486186"}}),Object(h.jsx)("div",{className:"DetailsLabel",children:"Tunnel ID"}),e.id,Object(h.jsx)("div",{className:"DetailsLabel",children:"Interface Name"}),e.name,Object(h.jsx)("div",{className:"DetailsLabel",children:"MAC"}),e.MAC,Object(h.jsx)("div",{className:"DetailsLabel",children:"State"}),e.State,Object(h.jsx)("div",{className:"DetailsLabel",children:"Tunnel Type"}),e.type,Object(h.jsx)("div",{className:"DetailsLabel",children:"ICE Role"}),e.stats.IceProperties.role,Object(h.jsx)("div",{className:"DetailsLabel",children:"Remote Address"}),e.stats.IceProperties.remote_addr,Object(h.jsx)("div",{className:"DetailsLabel",children:"Local Address"}),e.stats.IceProperties.local_addr,Object(h.jsx)("div",{className:"DetailsLabel",children:"Latency"}),e.stats.IceProperties.latency,Object(h.jsx)("br",{}),Object(h.jsx)("br",{}),Object(h.jsxs)(g.a.Body,{className:"transmissionCard",children:[Object(h.jsx)("div",{className:"DetailsLabel",children:"Byte Sent"}),e.stats.byte_sent,Object(h.jsx)("div",{className:"DetailsLabel",children:"Total Byte Sent"}),e.stats.total_byte_sent]}),Object(h.jsxs)(g.a.Body,{className:"transmissionCard",children:["Received",Object(h.jsx)("div",{className:"DetailsLabel",children:"Byte Received"}),e.stats.byte_receive,Object(h.jsx)("div",{className:"DetailsLabel",children:"Total Byte Received"}),e.stats.total_byte_receive]})]});b.a.render(o,document.getElementById("rightPanelContent"))}))}))},a.handleSwitch=function(){var e=Object(l.a)(a);new Promise((function(t,n){try{e.setState((function(e){return{switchToggle:!e.switchToggle}})),t(!0)}catch(a){n(a)}})).then((function(){e.swap()})).catch((function(e){}))},a.swap=function(){var e=Object(l.a)(a);new Promise((function(t,n){try{t(e.state.switchToggle?e.props.topology.getLinkDetails(e.state.currentSelectedElement.data().target,e.state.currentSelectedElement.data().id):e.props.topology.getLinkDetails(e.state.currentSelectedElement.data().source,e.state.currentSelectedElement.data().id))}catch(a){n(!1)}})).then((function(t){e.setState((function(e){return{linkDetails:{linkDetails:t,sourceNodeDetails:e.linkDetails.targetNodeDetails,targetNodeDetails:e.linkDetails.sourceNodeDetails}}}))})).then((function(){e.renderLinkDetails()})).catch((function(e){}))},a.setNodeDetails=function(e){var t=Object(l.a)(a);new Promise((function(n,a){try{var s=t.props.topology.getNodeDetails(e.data().id),c=t.cy.elements(e.incomers().union(e.outgoers())).filter((function(e){return e.isNode()}));t.setState({nodeDetails:{sourceNode:s,connectedNodes:c}}),n(!0)}catch(r){a(!1)}})).then((function(){t.renderNodeDetails()})).catch((function(){}))},a.setLinkDetails=function(e){var t=Object(l.a)(a);new Promise((function(n,a){try{var s=t.props.topology.getLinkDetails(e.data().source,e.data().id),c=e.data().source,r=e.data().target,l=t.props.topology.getNodeDetails(e.data().source),o=t.props.topology.getNodeDetails(e.data().target);t.setState({linkDetails:{linkDetails:s,sourceNode:c,targetNode:r,sourceNodeDetails:l,targetNodeDetails:o}}),n(!0)}catch(i){a(!1)}})).then((function(){t.renderLinkDetails()})).catch((function(){}))},a.renderGraph=function(){a.setState({currentView:"Topology"}),b.a.render(Object(h.jsx)(y.a,{id:"cy",cy:function(e){a.cy=e,a.setState({cytoscape:e}),a.cy.maxZoom(a.state.initMaxZoom),a.cy.minZoom(a.state.initMinZoom),a.cy.zoom(.8),a.cy.center();var t=Object(l.a)(a);if(null!==a.state.currentSelectedElement)if(a.state.currentSelectedElement.isNode()){var n=a.cy.elements().filter((function(e){return e.data().id===a.state.currentSelectedElement.data().id})).filter((function(e){return e.isNode()})),s=n.outgoers().union(n.incomers()).union(n),c=a.cy.elements().difference(n.outgoers().union(n.incomers())).not(n);n.select(),s.removeClass("transparent"),c.addClass("transparent")}else if(a.state.currentSelectedElement.isEdge()){var r=a.state.currentSelectedElement.connectedNodes().union(a.state.currentSelectedElement),o=a.cy.elements().difference(a.state.currentSelectedElement.connectedNodes()).not(a.state.currentSelectedElement);a.state.currentSelectedElement.select(),r.removeClass("transparent"),o.addClass("transparent")}a.cy.on("click",(function(e){var n,a,s=e.target[0];try{!0===document.getElementById("rightPanel").hidden&&document.getElementById("overlayRightPanelBtn").click(),s.isNode()?(t.setNodeDetails(s),n=s.outgoers().union(s.incomers()).union(s),a=t.cy.elements().difference(s.outgoers().union(s.incomers())).not(s)):s.isEdge()&&(t.setLinkDetails(s),n=s.connectedNodes().union(s),a=t.cy.elements().difference(s.connectedNodes()).not(s)),"Subgraph"!==document.getElementById("viewSelector").value&&(n.removeClass("transparent"),a.addClass("transparent"))}catch(c){e.target[0]===this.cy&&(b.a.render(Object(h.jsx)(h.Fragment,{}),document.getElementById("rightPanelContent")),t.cy.elements().removeClass("transparent"))}finally{e.target[0]!==this.cy?t.setState({switchToggle:!0,currentSelectedElement:e.target}):t.setState({switchToggle:!1,currentSelectedElement:null})}}))},wheelSensitivity:.1,elements:a.props.topology.getAlltopology(),stylesheet:B,style:{width:window.innerWidth,height:window.innerHeight},layout:{name:"circle"}}),document.getElementById("midArea")),b.a.render(Object(h.jsxs)("select",{defaultValue:"Topology",onChange:a.handleViewSelector,id:"viewSelector",className:"custom-select",children:[Object(h.jsx)("option",{value:"Topology",children:"Topology"}),Object(h.jsx)("option",{value:"Subgraph",children:"Subgraph"}),Object(h.jsx)("option",{value:"Map",children:"Map"}),Object(h.jsx)("option",{value:"Log",children:"Log"}),Object(h.jsx)("option",{value:"NetworkFlow",children:"NetworkFlow"}),Object(h.jsx)("option",{value:"TunnelUtilization",children:"TunnelUtilization"})]}),document.getElementById("viewBar"))},a.elementFilter=function(e,t){return e.group,-1!==e.data().label.toLowerCase().indexOf(t.text.toLowerCase())||-1!==e.data().id.toLowerCase().indexOf(t.text.toLowerCase())},a.handleRefresh=function(){a.cy.zoom(.8),document.getElementById("zoomSlider").value=a.cy.zoom(),a.cy.center()},a.zoomIn=function(){var e=a.cy.zoom();a.cy.zoom(e+.1),document.getElementById("zoomSlider").value=a.cy.zoom()},a.zoomOut=function(){var e=a.cy.zoom();a.cy.zoom(e-.1),document.getElementById("zoomSlider").value=a.cy.zoom()},a.handleZoomSlider=function(e){a.cy.zoom(parseFloat(e.target.value))},a.handleWheel=function(e){document.getElementById("zoomSlider").value=a.cy.zoom()},a.handleSetMinZoom=function(e){try{a.cy.minZoom(parseFloat(e.target.value)),document.getElementById("zoomSlider").min=parseFloat(e.target.value)}finally{a.cy.zoom()<parseFloat(e.target.value)&&a.cy.zoom(parseFloat(e.target.value)),a.setState({setMinZoom:e.target.value})}},a.handleSetMaxZoom=function(e){try{a.cy.maxZoom(parseFloat(e.target.value)),document.getElementById("zoomSlider").max=parseFloat(e.target.value)}finally{a.cy.zoom()>parseFloat(e.target.value)&&a.cy.zoom(parseFloat(e.target.value)),a.setState({setMinZoom:e.target.value})}},a.handleBackToHome=function(){!0===window.confirm("Your current process will be loss. Are you sure to go back ?")&&window.location.reload(!0)},a.renderSubgraph=function(){var e,t=a.state.currentSelectedElement;if("Map"!==a.state.currentView)try{t.isNode()?e=a.cy.elements().difference(t.outgoers().union(t.incomers())).not(t):t.isEdge()&&(e=a.cy.elements().difference(t.connectedNodes()).not(t)),e.addClass("subgraph"),a.setState({currentView:"Subgraph"})}catch(n){alert("Please select node or tunnel."),document.getElementById("viewSelector").value=a.state.currentView}else alert("Map is not available for this view."),document.getElementById("viewSelector").value=a.state.currentView},a.renderTopology=function(){document.getElementById("elementBreadcrumb").hidden=!1,document.getElementById("overlayBreadcrumb").hidden=!1,document.getElementById("homeBtn").hidden=!1,document.getElementById("refreshBtn").hidden=!1,document.getElementById("configBtn").hidden=!1,document.getElementById("infoBtn").hidden=!1,document.getElementById("plusBtn").hidden=!1,document.getElementById("minusBtn").hidden=!1,document.getElementById("zoomSlider").hidden=!1,"Subgraph"===a.state.currentView?a.cy.elements().removeClass("subgraph"):"Map"===a.state.currentView&&a.renderGraph()},a.handleMakerClicked=function(e){a.state.currentSelectedElement.isNode()&&(e.trigger("click"),document.getElementById(e.data().id+"Marker").classList.add("selected"),a.setState({switchToggle:!1,currentSelectedElement:e}))},a.midpoint=function(e,t,n,s){e=a.deg2rad(e),t=a.deg2rad(t),n=a.deg2rad(n);var c=(s=a.deg2rad(s))-t,r=Math.cos(n)*Math.cos(c),l=Math.cos(n)*Math.sin(c),o=Math.atan2(Math.sin(e)+Math.sin(n),Math.sqrt((Math.cos(e)+r)*(Math.cos(e)+r)+l*l)),i=t+Math.atan2(l,Math.cos(e)+r);return[180*o/Math.PI,180*i/Math.PI]},a.deg2rad=function(e){return e*Math.PI/180},a.hasCoordinate=function(e){return!!e.data("coordinate").split(",")[1]},a.renderMap=function(){var e=Object(l.a)(a);if(null!==a.state.currentSelectedElement){if(a.state.currentSelectedElement.isEdge())new Promise((function(t,n){try{var s,c,r=a.state.currentSelectedElement,o=r.connectedNodes().filter((function(t){return e.hasCoordinate(t)})),i=r.connectedNodes().filter((function(t){return!1===e.hasCoordinate(t)}));0!==o.length?(s=a.midpoint(parseFloat(o[0].data().coordinate.split(",")[0]),parseFloat(o[0].data().coordinate.split(",")[1]),parseFloat(o[1].data().coordinate.split(",")[0]),parseFloat(o[1].data().coordinate.split(",")[1])),c=Object(h.jsx)(R.a,{bootstrapURLKeys:{key:"AIzaSyBjkkk4UyMh4-ihU1B1RR7uGocXpKECJhs",language:"en"},center:{lat:s[0],lng:s[1]},defaultZoom:10,children:o.map((function(e){return Object(h.jsx)("button",{onClick:a.handleMakerClicked.bind(Object(l.a)(a),e),id:e.data().id+"Marker",className:"nodeMarker selected",lat:parseFloat(e.data().coordinate.split(",")[0]),lng:parseFloat(e.data().coordinate.split(",")[1]),children:Object(h.jsx)("label",{className:"markerLabel",children:e.data().label})},e.data().id+"Marker")}))})):(s=[parseFloat("15.8700"),parseFloat("100.9925")],c=Object(h.jsx)(R.a,{bootstrapURLKeys:{key:"AIzaSyBjkkk4UyMh4-ihU1B1RR7uGocXpKECJhs",language:"en"},center:{lat:s[0],lng:s[1]},defaultZoom:10,children:Object(h.jsxs)(g.a,{id:"non-coordinate-card",children:[Object(h.jsx)(g.a.Header,{children:"Unmapped nodes."}),Object(h.jsx)(g.a.Body,{children:i.map((function(e){return Object(h.jsx)("button",{onClick:a.handleMakerClicked.bind(Object(l.a)(a),e),id:e.data().id+"Marker",className:"nodeMarker",children:Object(h.jsx)("label",{className:"markerLabel",children:e.data().label})},e.data().id+"Marker")}))})]})})),a.setState({currentView:"Map"}),b.a.render(c,document.getElementById("midArea")),t(!0)}catch(d){console.log(d),n(!1)}})).then((function(){e.state.currentSelectedElement}));else if(a.state.currentSelectedElement.isNode()){new Promise((function(e,t){try{var n,s=a.state.currentSelectedElement,c=s.outgoers().union(s.incomers()).union(s).filter((function(e){return e.isNode()&&a.hasCoordinate(e)}));n=0!==c.length?Object(h.jsx)(R.a,{bootstrapURLKeys:{key:"AIzaSyBjkkk4UyMh4-ihU1B1RR7uGocXpKECJhs",language:"en"},center:{lat:parseFloat(s.data().coordinate.split(",")[0]),lng:parseFloat(s.data().coordinate.split(",")[1])},defaultZoom:10,children:c.map((function(e){return Object(h.jsx)("button",{onClick:a.handleMakerClicked.bind(Object(l.a)(a),e),id:e.data().id+"Marker",className:"nodeMarker",lat:parseFloat(e.data().coordinate.split(",")[0]),lng:parseFloat(e.data().coordinate.split(",")[1]),children:Object(h.jsx)("label",{className:"markerLabel",children:e.data().label})},e.data().id+"Marker")}))}):Object(h.jsx)(R.a,{bootstrapURLKeys:{key:"AIzaSyBjkkk4UyMh4-ihU1B1RR7uGocXpKECJhs",language:"en"},center:{lat:parseFloat("15.8700"),lng:parseFloat("100.9925")},defaultZoom:10}),b.a.render(n,document.getElementById("midArea")),a.setState({currentView:"Map"}),e(!0)}catch(r){t(!1)}})).then((function(){null!==e.state.currentSelectedElement&&null!==document.getElementById(e.state.currentSelectedElement.data().id+"Marker")&&document.getElementById(e.state.currentSelectedElement.data().id+"Marker").classList.add("selected")}))}}else alert("Please select some node or tunnel."),document.getElementById("viewSelector").value=a.state.currentView},a.handleViewSelector=function(e){switch(e.target.value){case"Subgraph":a.renderSubgraph();break;case"Topology":a.renderTopology();break;case"Map":a.renderMap()}},a.state={initMinZoom:.2,initMaxZoom:2,setMinZoom:.2,setMaxZoom:2,graphElement:[],dataReady:!1,refresh:!1,switchToggle:!1,infoToggle:!0,configToggle:!0,nodeDetails:null,linkDetails:null,currentSelectedElement:null,currentView:null},a}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.renderGraph(),new Promise((function(t,n){try{t(e.props.topology.getAlltopology().map((function(e){return JSON.stringify(e)})))}catch(a){n(a)}})).then((function(t){b.a.render(Object(h.jsx)(E.Typeahead,{id:"searchOverlay",onChange:function(t){try{e.cy.elements().getElementById(JSON.parse(t).data.id).trigger("click"),e.cy.elements().getElementById(JSON.parse(t).data.id).select()}catch(n){e.cy.elements().removeClass("transparent"),b.a.render(Object(h.jsx)(h.Fragment,{}),document.getElementById("rightPanelContent"))}},labelKey:function(e){return"".concat(JSON.parse(e).data.label)},options:t,selected:e.state.selected,selectHintOnEnter:!0,placeholder:"select a node or tunnel",renderMenuItemChildren:function(e){return Object(h.jsxs)("div",{className:"searchResult",children:[Object(h.jsx)("div",{className:"resultLabel",children:Object(h.jsx)("b",{children:JSON.parse(e).data.label})}),Object(h.jsx)("small",{className:"resultLabel",children:"ID : ".concat(JSON.parse(e).data.id)}),Object(h.jsx)("br",{})]})}}),document.getElementById("searchBar"))}))}},{key:"componentDidUpdate",value:function(){var e=this;null!=this.cy&&void 0!=this.cy&&this.cy.elements("nodes").toArray().forEach((function(e){0==e.incomers().length&&0==e.outgoers().length&&e.addClass("noTunnel")}));if("Map"===this.state.currentView){document.getElementById("elementBreadcrumb").hidden=!0,document.getElementById("overlayBreadcrumb").hidden=!0,document.getElementById("homeBtn").hidden=!0,document.getElementById("refreshBtn").hidden=!0,document.getElementById("configBtn").hidden=!0,document.getElementById("infoBtn").hidden=!0,document.getElementById("plusBtn").hidden=!0,document.getElementById("minusBtn").hidden=!0,document.getElementById("zoomSlider").hidden=!0;var t=this.state.currentSelectedElement;if(this.state.currentSelectedElement.isNode())try{var n,a=t.outgoers().union(t.incomers()).union(t).filter((function(t){return t.isNode()&&e.hasCoordinate(t)}));n=0!==a.length?Object(h.jsx)(R.a,{bootstrapURLKeys:{key:"AIzaSyBjkkk4UyMh4-ihU1B1RR7uGocXpKECJhs",language:"en"},center:{lat:parseFloat(t.data().coordinate.split(",")[0]),lng:parseFloat(t.data().coordinate.split(",")[1])},defaultZoom:8,children:a.map((function(t){return t.data().id===e.state.currentSelectedElement.data().id?Object(h.jsx)("button",{onClick:e.handleMakerClicked.bind(e,t),id:t.data().id+"Marker",className:"nodeMarker selected",lat:parseFloat(t.data().coordinate.split(",")[0]),lng:parseFloat(t.data().coordinate.split(",")[1]),children:Object(h.jsx)("label",{className:"markerLabel",children:t.data().label})},t.data().id+"Marker"):Object(h.jsx)("button",{onClick:e.handleMakerClicked.bind(e,t),id:t.data().id+"Marker",className:"nodeMarker",lat:parseFloat(t.data().coordinate.split(",")[0]),lng:parseFloat(t.data().coordinate.split(",")[1]),children:Object(h.jsx)("label",{className:"markerLabel",children:t.data().label})},t.data().id+"Marker")}))}):Object(h.jsx)(R.a,{bootstrapURLKeys:{key:"AIzaSyBjkkk4UyMh4-ihU1B1RR7uGocXpKECJhs",language:"en"},center:{lat:parseFloat("15.8700"),lng:parseFloat("100.9925")},defaultZoom:8}),b.a.render(n,document.getElementById("midArea"))}catch(o){alert("You have to select a node."),document.getElementById("viewSelector").value=this.state.currentView}else if(this.state.currentSelectedElement.isEdge())try{var s,c,r=t.connectedNodes().filter((function(t){return e.hasCoordinate(t)})),l=t.connectedNodes().filter((function(t){return!1===e.hasCoordinate(t)}));0!==r.length?(s=this.midpoint(parseFloat(r[0].data().coordinate.split(",")[0]),parseFloat(r[0].data().coordinate.split(",")[1]),parseFloat(r[1].data().coordinate.split(",")[0]),parseFloat(r[1].data().coordinate.split(",")[1])),c=Object(h.jsx)(R.a,{bootstrapURLKeys:{key:"AIzaSyBjkkk4UyMh4-ihU1B1RR7uGocXpKECJhs",language:"en"},center:{lat:s[0],lng:s[1]},defaultZoom:10,children:r.map((function(t){return Object(h.jsx)("button",{onClick:e.handleMakerClicked.bind(e,t),id:t.data().id+"Marker",className:"nodeMarker selected",lat:parseFloat(t.data().coordinate.split(",")[0]),lng:parseFloat(t.data().coordinate.split(",")[1]),children:Object(h.jsx)("label",{className:"markerLabel",children:t.data().label})},t.data().id+"Marker")}))})):(s=[parseFloat("15.8700"),parseFloat("100.9925")],c=Object(h.jsx)(R.a,{bootstrapURLKeys:{key:"AIzaSyBjkkk4UyMh4-ihU1B1RR7uGocXpKECJhs",language:"en"},center:{lat:s[0],lng:s[1]},defaultZoom:10,children:Object(h.jsxs)(g.a,{id:"non-coordinate-card",children:[Object(h.jsx)(g.a.Header,{children:"Unmapped nodes."}),Object(h.jsx)(g.a.Body,{children:l.map((function(t){return Object(h.jsx)("button",{onClick:e.handleMakerClicked.bind(e,t),id:t.data().id+"Marker",className:"nodeMarker",children:Object(h.jsx)("label",{className:"markerLabel",children:t.data().label})},t.data().id+"Marker")}))})]})})),b.a.render(c,document.getElementById("midArea"))}catch(o){}}}},{key:"render",value:function(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{id:"leftTools",children:[Object(h.jsx)("button",{id:"elementBreadcrumb",className:"leftToolsBtn",children:Object(h.jsx)("div",{className:"breadcrumbLabel",children:null!==this.state.currentSelectedElement?this.state.currentSelectedElement.isNode()?"Node : "+this.state.currentSelectedElement.data().label:"Tunnel : "+this.state.currentSelectedElement.data().label:"None."})}),Object(h.jsx)("button",{id:"overlayBreadcrumb",className:"leftToolsBtn",children:Object(h.jsxs)("div",{className:"breadcrumbLabel",children:["Overlay : ",this.props.overlayName]})}),Object(h.jsx)("div",{children:Object(h.jsx)("button",{onClick:this.handleBackToHome,id:"homeBtn",className:"leftToolsBtn"})}),Object(h.jsx)("div",{children:Object(h.jsx)("button",{onClick:this.handleRefresh,id:"refreshBtn",className:"leftToolsBtn"})}),Object(h.jsx)("div",{children:Object(h.jsx)(C.a,{rootClose:!0,trigger:"click",placement:"right",overlay:Object(h.jsxs)(k.a,{children:[Object(h.jsx)(k.a.Title,{as:"h3",children:"IPOP Network Visualizer : Legend"}),Object(h.jsx)(k.a.Content,{id:"infoContent",children:Object(h.jsxs)("table",{children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{colSpan:2,children:"Node"}),Object(h.jsx)("th",{colSpan:2,children:"Tunnel"})]})}),Object(h.jsxs)("tbody",{children:[Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{style:{width:"5%",margin:"auto"},children:Object(h.jsx)("img",{className:"node_img",src:D,alt:"connected_node"})}),Object(h.jsx)("td",{children:"Connected"}),Object(h.jsx)("td",{style:{width:"15%"},children:Object(h.jsx)("img",{className:"tunnel_img",src:L,alt:"longdistance_tunnel"})}),Object(h.jsx)("td",{children:"Long Distance"})]}),Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{style:{width:"5%"},children:Object(h.jsx)("img",{className:"node_img",src:T,alt:"not_reporting_node"})}),Object(h.jsx)("td",{children:"Not Reporting"}),Object(h.jsx)("td",{style:{width:"15%"},children:Object(h.jsx)("img",{className:"tunnel_img",src:w,alt:"ondemand_tunnel"})}),Object(h.jsx)("td",{children:"On Demand"})]}),Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{style:{width:"5%"},children:Object(h.jsx)("img",{className:"node_img",src:I,alt:"no_tunnel_node"})}),Object(h.jsx)("td",{children:"No Tunnels"}),Object(h.jsx)("td",{style:{width:"15%"},children:Object(h.jsx)("img",{className:"tunnel_img",src:S,alt:"static_tunnel"})}),Object(h.jsx)("td",{children:"Static"})]}),Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{}),Object(h.jsx)("td",{}),Object(h.jsx)("td",{style:{width:"15%"},children:Object(h.jsx)("img",{className:"tunnel_img",src:M,alt:"successor_tnnel"})}),Object(h.jsx)("td",{children:"Successor"})]})]})]})})]}),children:Object(h.jsx)("button",{onClick:this.handleInfoToggle,id:"infoBtn",className:"leftToolsBtn"})})}),Object(h.jsx)("div",{children:Object(h.jsx)(C.a,{rootClose:!0,trigger:"click",placement:"right",overlay:Object(h.jsxs)(k.a,{children:[Object(h.jsx)(k.a.Title,{as:"h3",children:"IPOP Network Visualizer : Configure"}),Object(h.jsxs)(k.a.Content,{id:"configContent",children:[Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)("div",{className:"col",children:Object(h.jsx)("label",{children:"Minimun zoom"})}),Object(h.jsx)("div",{className:"col",children:Object(h.jsxs)("select",{defaultValue:this.state.setMinZoom,onChange:this.handleSetMinZoom,id:"minZoomSelector",value:this.state.minZoom,children:[Object(h.jsx)("option",{id:"0.2",children:"0.2"}),Object(h.jsx)("option",{id:"1",children:"1"})]})})]}),Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)("div",{className:"col",children:Object(h.jsx)("label",{children:"Maximum zoom"})}),Object(h.jsx)("div",{className:"col",children:Object(h.jsxs)("select",{defaultValue:this.state.setMaxZoom,onChange:this.handleSetMaxZoom,id:"maxZoomSelector",value:this.state.maxZoom,children:[Object(h.jsx)("option",{children:"2"}),Object(h.jsx)("option",{children:"5"})]})})]})]})]}),children:Object(h.jsx)("button",{onClick:this.handleConfigToggle,id:"configBtn",className:"leftToolsBtn"})})}),Object(h.jsx)("div",{children:Object(h.jsx)("button",{onClick:this.zoomIn,id:"plusBtn",className:"leftToolsBtn"})}),Object(h.jsx)("div",{children:Object(h.jsx)("input",{id:"zoomSlider",onChange:this.handleZoomSlider,type:"range",min:this.state.initMinZoom,max:this.state.initMaxZoom,step:.1,defaultValue:.8})}),Object(h.jsx)("div",{children:Object(h.jsx)("button",{onClick:this.zoomOut,id:"minusBtn",className:"leftToolsBtn"})})]}),Object(h.jsx)("section",{onWheel:this.handleWheel,style:{width:"100vw",height:"100vh"},children:Object(h.jsx)("div",{id:"midArea"})}),Object(h.jsx)(m,{rightPanelTopic:"Details"})]})}}]),n}(s.a.Component),z=n.p+"static/media/ipop_ic.9a776127.svg",F=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).handleRightPanelToggle=function(){new Promise((function(e,t){try{a.setState((function(e){return{isToggle:!e.isToggle}})),e()}catch(n){console.log(n)}})).then((function(){a.state.isToggle?document.getElementById("rightPanel").hidden=!1:document.getElementById("rightPanel").hidden=!0}))},a.state={isToggle:!0},a}return Object(r.a)(n,[{key:"render",value:function(){return Object(h.jsxs)("header",{id:"header",className:"row",style:{padding:"0.2%",margin:"0"},children:[Object(h.jsxs)("div",{id:"ipopTitle",className:"col-2",style:{margin:"0"},children:[Object(h.jsx)("img",{id:"ipopLogo",src:z,alt:"ipop_ic"}),Object(h.jsx)("label",{id:"ipopTitle",style:{marginTop:"0.5rem",color:"white"},children:"IPOP NETWORK VISUALIZER"})]}),Object(h.jsx)("div",{id:"viewBar",className:"col-5"}),Object(h.jsx)("div",{id:"searchBar",className:"col-2",style:{padding:0,margin:0},children:this.props.children}),Object(h.jsx)("button",{onClick:this.handleRightPanelToggle,id:"rightPanelBtn"})]})}}]),n}(s.a.Component),A=(n(347),{ip:"localhost",port:"3000"}),U=function e(t){var n=this;Object(c.a)(this,e);var a=[];t.forEach((function(e){return e.Overlays.forEach((function(e){console.log(e);var t={name:e.OverlayId,numberOfNodes:e.NumNodes,numberOfLinks:e.NumEdges};a.push(t)}))})),this.getOverlayList=function(){return a},this.getOverlayName=function(){var e=[];return n.getOverlayList().forEach((function(t){e.push(t.name)})),e},this.getOverlay=function(e){return a.find((function(t){return t.name===e}))},this.getNumberOfNodes=function(e){return a.find((function(t){return t.name===e})).numberOfNodes},this.getNumberOfLinks=function(e){return a.find((function(t){return t.name===e})).numberOfLinks},this.getOverlayDescription=function(e){return"EVio"}},Z=function e(t,n){var a=this;Object(c.a)(this,e);var s=t,r=n,l=[];this.addNodeElement=function(e){var t=a.getNodeDetails(e);l.push(JSON.parse('{"group":"nodes","data": {"id": "'.concat(t.id,'","label": "').concat(t.name,'","state":"","type":"","coordinate":"').concat(a.getCoordinate(e),'"}}')))},this.getCoordinate=function(e){try{return[s[e].geo_coordinate.split(",")[0],s[e].geo_coordinate.split(",")[1]]}catch(t){return"-"}},this.addLinkElement=function(e,t){var n,s=a.getLinkDetails(e,t);switch(s.type){case"CETypeILongDistance":case"CETypeLongDistance":n="#5E4FA2";break;case"CETypePredecessor":case"CETypeSuccessor":n="#01665E"}l.push(JSON.parse('{"group":"edges","data": { "id":"'.concat(s.id,'" ,"label":"').concat(s.name,'","source": "').concat(s.source,'","target": "').concat(s.target,'","state":"","type":"').concat(s.type,'","color":"').concat(n,'"}}')))},this.getAlltopology=function(){return l},this.getNodeDetails=function(e){return{name:s[e].node_name,id:e,state:"-",raw_data:s}},this.getLinkDetails=function(e,t){return{name:r[e][t].tap_name,id:t,MAC:r[e][t].mac,state:r[e][t].state,type:r[e][t].edge_type,role:"-",stats:r[e][t].ChannelProperties,source:r[e][t].SrcNodeID,target:r[e][t].TgtNodeID,raw_data:r}},this.getConnectedNodeDetails=function(e,t){var n;return Object.keys(r[e]).forEach((function(s){r[e][s].TgtNodeID===t&&(n=a.getLinkDetails(e,s))})),n}},K=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).handleRightPanelToggle=function(){new Promise((function(e,t){try{a.setState((function(e){return{isToggle:!e.isToggle}})),e()}catch(n){}})).then((function(){a.state.isToggle?document.getElementById("rightPanel").hidden=!1:document.getElementById("rightPanel").hidden=!0}))},a.renderMainContent=function(){return null!==a.state.overlays?null!==a.state.selectedOverlay?null!==a.state.topology?a.renderGraphContent():Object(h.jsx)(d.a,{id:"loading",animation:"border",variant:"info"}):a.renderOverlaysContent():Object(h.jsx)(d.a,{id:"loading",animation:"border",variant:"info"})},a.renderGraphContent=function(){return Object(h.jsx)(P,{overlayName:a.state.selectedOverlay,topology:a.state.topology})},a.renderOverlaysContent=function(){var e=a.state.overlays.getOverlayName().map((function(e){return Object(h.jsx)(u.Tooltip,{className:"overlayTooltips",sticky:!0,duration:"500",animation:"scale",interactive:!0,position:"bottom",arrow:!0,open:!0,html:Object(h.jsx)("div",{children:e}),children:Object(h.jsx)("button",{onClick:a.selectOverlay.bind(Object(l.a)(a),e),id:e,className:"overlay"})},e)}));return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{id:"overlayList",children:e}),Object(h.jsx)(m,{rightPanelTopic:"Overlays (".concat(a.state.overlays.getOverlayList().length,")"),children:a.renderRightPanel()})]})},a.renderRightPanel=function(){return a.renderOverlayBtn()},a.renderOverlayBtn=function(){return a.state.overlays.getOverlayName().map((function(e){return Object(h.jsx)(N,{onClick:"s",id:e+"Btn",name:e,className:"overlayBtn",children:Object(h.jsxs)("div",{children:[a.state.overlays.getOverlayDescription(e),Object(h.jsx)("br",{}),"Number of nodes : ",a.state.overlays.getNumberOfNodes(e),Object(h.jsx)("br",{}),"Number of links : ",a.state.overlays.getNumberOfLinks(e)]})},e+"Btn")}))},a.selectOverlay=function(e){a.setState({selectedOverlay:e});var t=(new Date).toISOString().split(".")[0],n="https://cors-anywhere.herokuapp.com/",s=n+"http://"+A.ip+":"+A.port+"/IPOP/overlays/"+e+"/nodes?interval="+t+"&current_state=True",c=n+"http://"+A.ip+":"+A.port+"/IPOP/overlays/"+e+"/links?interval="+t+"&current_state=True",r=null;try{fetch(s).then((function(e){return e.json()})).then((function(t){fetch(c).then((function(e){return e.json()})).then((function(n){r=new Z(t[e].current_state,n[e].current_state);var a=t[e].current_state;return Object.keys(a).sort().forEach((function(t){r.addNodeElement(t);var a=n[e].current_state[t];try{Object.keys(a).forEach((function(e){r.addLinkElement(t,e)}))}catch(s){console.log("".concat(t," has no tunnel."))}})),r})).then((function(e){a.setState({topology:e})}))}))}catch(l){}},a.state={overlays:null,selectedOverlay:null,topology:null,isToggle:!0},a}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this,t="http://"+A.ip+":"+A.port+"/overlays?interval=100.42";console.log(t),fetch(t).then((function(e){return e.json()})).then((function(e){return new U(e)})).then((function(t){e.setState({overlays:t})})).catch((function(){}))}},{key:"render",value:function(){var e=this;return Object(h.jsxs)("div",{id:"container",className:"container-fluid",style:{padding:"0"},children:[Object(h.jsx)(F,{children:Object(h.jsx)(E.Typeahead,{id:"searchOverlay",onChange:function(t){try{e.selectOverlay(t[0])}catch(n){}},options:null!==this.state.overlays?this.state.overlays.getOverlayName():[],selected:this.state.selected,selectHintOnEnter:!0,placeholder:"Search overlay",renderMenuItemChildren:function(t){return Object(h.jsxs)("div",{className:"searchResult",children:[Object(h.jsx)("div",{className:"resultLabel",children:t}),Object(h.jsx)("small",{className:"resultLabel",children:"Number of nodes :  ".concat(e.state.overlays.getNumberOfNodes(t)," Number of links : ").concat(e.state.overlays.getNumberOfLinks(t))}),Object(h.jsx)("br",{})]})}})}),Object(h.jsx)("div",{id:"mainContent",className:"row",style:{backgroundColor:"#101B2B",color:"white",margin:"auto"},children:this.renderMainContent()})]})}}]),n}(s.a.Component);var V=function(){return Object(h.jsx)(K,{})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));b.a.render(Object(h.jsx)(V,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[348,1,2]]]);
//# sourceMappingURL=main.a34376ee.chunk.js.map